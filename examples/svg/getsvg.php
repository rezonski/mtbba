<?php
  // Putanja         - 
  // Moguci smjerovi - 
  // Voda            - v
  // Zabranjeno      - z
  // Naselje/kuce    - n
  // Most            - m
  // Rijeka/potok    - r
  // Odmoriste/izlet - o
  // hrana/restoran  - h
  // planinarski dom - p
  // plan.prevoj     - x
  // tunel           - t
  // 
  // Pozadine:
  // livada          - l
  // suma            - s
  // kamenjar        - k
  // grad/urbano     - g
  header("Content-type: image/svg+xml");
  print('<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>');
?>

<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/SVG/DTD/svg10.dtd">
<svg height="900" width="900" xmlns="http://www.w3.org/2000/svg">
<g>

<?php
  function fugao($vugao) {
    if ($vugao < 0 ) {
      return fugao($vugao+360);
    } else {
      return $vugao%360;
    }
  };

  function sign( $number ) { 
    return ( $number > 0 ) ? 1 : ( ( $number < 0 ) ? -1 : 0 ); 
  } 

  function getCoordinates($vugao) {
    $x = 0;
    $y = 0;
    // $ugao = fugao(360-(int)$vugao);
    $ugao = (int)$vugao;
    
    $sin = abs(sin(deg2rad($ugao)));
    $cos = abs(cos(deg2rad($ugao)));


    if ($vugao%90 != 0) {
      if ($sin < $cos) {
        $x = 1;
        $y = $sin / $cos;
      } else if ($sin > $cos) {
        $x = $cos / $sin;
        $y = 1;
      } else {
        $x = 1;
        $y = 1;
      }
    } else if ($vugao == 0 || $vugao == 180) {
      $x = 1;
    } else if ($vugao == 90 || $vugao == 270) {
      $y = 1;
    }

    $x = abs($x) * sign(cos(deg2rad($ugao)));
    $y = -1 * abs($y) * sign(sin(deg2rad($ugao)));
    // echo "Angle ".$vugao." - (x,y) = (".$x.",".$y.")";
    return array($x, $y);
  }
  // Put
  function printPut($boja, $ugao) {
    echo "<g id=\"put-".$ugao."\" transform=\"rotate(-".$ugao." 450 450)\">
       <path fill=\"".$boja."\" d=\"M456.375,489.823c23.981,0.014,47.963,0.026,71.945,0.04c56.397,0.031,112.795,0.063,169.192,0.094,c65.493,0.036,130.986,0.073,196.479,0.109c51.268,0.028,102.534,0.057,153.802,0.085c15.11,0.009,30.222,0.017,45.332,0.025,c21.805,0.012,40-18.204,40-40c0-21.814-18.195-39.988-40-40c-23.981-0.013-47.963-0.027-71.945-0.04,c-56.397-0.031-112.795-0.063-169.192-0.094c-65.493-0.037-130.986-0.073-196.479-0.109,c-51.268-0.028-102.534-0.057-153.802-0.085c-15.11-0.009-30.222-0.017-45.332-0.025c-21.805-0.012-40,18.205-40,40,C416.375,471.637,434.57,489.812,456.375,489.823L456.375,489.823z\"/>
      </g>";
  }
  // Glavni put
  function printPutanja($ugao) {
    printPut("#FF0000", $ugao);
  }
  // Sporedni put
  function printSmjer($ugao) {
    printPut("#CCCCCC", $ugao);
  }
  //Most
  function printMost($ugao) { 
    echo "<g id=\"most-".$ugao."\" transform=\"rotate(-".$ugao." 450 450)\">
      <rect id=\"canalw_3_\" x=\"702.205\" y=\"539.166\" fill=\"#0071BC\" width=\"109.09\" height=\"360.334\"/>
      <rect id=\"canale_3_\" x=\"702.205\" fill=\"#0071BC\" width=\"109.09\" height=\"360.833\"/>
      <polyline id=\"bridge01_3_\" fill=\"none\" stroke=\"#333333\" stroke-width=\"40\" points=\"636.75,546.45 680.387,513.877,833.113,513.876 876.75,546.45\"/>
      <polyline id=\"bridge02_3_\" fill=\"none\" stroke=\"#333333\" stroke-width=\"40\" points=\"636.75,352.72 680.387,385.294,833.113,385.294 876.75,352.72\"/>
    </g>";
  }
  //Rijeka
  function printRijekaPotok($ugao) { 
    echo "<g id=\"rijeka-potok-".$ugao."\" transform=\"rotate(-".$ugao." 450 450)\">
      <rect id=\"rijeka_1_\" x=\"702.205\" y=\"-300\" fill=\"#0071BC\" width=\"109.09\" height=\"1500\"/>
    </g>";
  }
  //Prevoj
  function printPrevoj($ugao) { 
    echo "<g id=\"prevoj-".$ugao."\" transform=\"rotate(-".$ugao." 450 450)\">
      <polyline id=\"bridge01_8_\" fill=\"none\" stroke=\"#333333\" stroke-width=\"40\" points=\"636.75,546.45,680.387,513.877,833.113,513.876 876.75,546.45\"/>
      <polyline id=\"bridge02_8_\" fill=\"none\" stroke=\"#333333\" stroke-width=\"40\" points=\"636.75,352.72,680.387,385.294,833.113,385.294 876.75,352.72\"/>
    </g>";
  }
  //Zabranjeno
  function printZabrana($ugao,$offset) { 
    echo "<g id=\"zabrana-".$ugao."\" transform=\"translate(".getCoordinates($ugao)[0]*$offset.",".getCoordinates($ugao)[1]*$offset.")\">
      <circle id=\"circle3030\" fill=\"#FFFFFF\" stroke=\"#D40000\" stroke-width=\"32\" cx=\"450\" cy=\"450\" r=\"108.211\"/>
      <path id=\"path3818\" fill=\"#D40000\" d=\"M365.996,514.586,l20.098,20.098l149.27-149.27l-20.1-20.098L365.996,514.586z\"/>
    </g>";
  }
  //Planinarki dom
  function printPD($ugao,$offset) { 
    echo "<g id=\"pd-".$ugao."\" transform=\"translate(".getCoordinates($ugao)[0]*$offset.",".getCoordinates($ugao)[1]*$offset.")\">
      <path id=\"rect3055\" fill=\"none\" stroke=\"#603813\" stroke-width=\"22\" stroke-linejoin=\"round\" d=\"M450,330.986l-118.6,118.6l33.885-0.004v118.604h169.429V449.586H568.6L450,330.986z\"/>
      <path id=\"path3501\" fill=\"#603813\" d=\"M461.946,418.902c7.727,0,13.973-6.288,13.973-14.031,c0-7.727-6.246-13.977-13.973-13.977c-7.735,0-14.023,6.25-14.023,13.977C447.923,412.614,454.211,418.902,461.946,418.902z\"/>
      <path id=\"path3503\" fill=\"#603813\" d=\"M438.286,421.219c0.546-2.155-0.818-4.302-2.938-4.844,l-11.66-2.805c-2.184-0.505-4.339,0.782-4.83,2.925l-9.808,40.586c-0.542,2.151,0.78,4.303,2.937,4.841l11.702,2.804,c2.118,0.547,4.302-0.777,4.807-2.938L438.286,421.219z\"/>
      <path id=\"path3507\" fill=\"#603813\" d=\"M413.971,557.183c-0.132,0.662-0.173,1.324-0.173,1.986,c0,5.46,4.397,9.837,9.849,9.837c4.476,0,8.232-2.979,9.439-7.024L450,491.944l16.123,69.624c1.035,4.302,4.925,7.445,9.507,7.445,c5.46,0,9.844-4.385,9.844-9.845c0-0.744-0.082-1.456-0.214-2.151l-22.114-92.49l1.854-8.148l1.456,6.402,c1.324,4.187,5.121,4.592,5.121,4.592l22.8,5.799c0.447,0.084,0.909,0.125,1.356,0.125c3.723,0,6.734-2.979,6.734-6.702,c0-3.192-2.185-5.874-5.162-6.576l-19.731-4.973l-5.41-22.006c-2.573-12.285-14.312-11.99-14.312-11.99,c-11.409-0.295-14.267,11.714-14.267,11.714L413.971,557.183L413.971,557.183z\"/>
    </g>";
  }
  //Izletiste/odmoriste
  function printOdmor($ugao,$offset) { 
    echo "<g id=\"ormor-".$ugao."\" transform=\"translate(".getCoordinates($ugao)[0]*$offset.",".getCoordinates($ugao)[1]*$offset.")\">
      <path fill=\"#231F20\" d=\"M417.058,445.884h61.436l-20.257-50.092h-20.922L417.058,445.884z M382.759,395.792v-18.524H517.26v18.524,h-33.953l20.208,50.092h50.095v18.51h-42.549l23.673,58.339h-22.988l-23.672-58.339h-76.497l-23.512,58.337h-22.99l23.513-58.34,h-42.196v-18.507h49.742l20.258-50.092H382.759z\"/>
    </g>";
  }
  //Voda
  function printVoda($ugao,$offset) { 
    // echo "<g id=\"voda-".$ugao."\" transform=\"translate(100,100)\">
    echo "<g id=\"voda-".$ugao."\" transform=\"translate(".getCoordinates($ugao)[0]*$offset.",".getCoordinates($ugao)[1]*$offset.")\">
      <path id=\"path6710_1_\" fill=\"#0000FF\" stroke=\"#666666\" stroke-miterlimit=\"10\" d=\"M545.299,575.242,c16.523,0,29.93-13.432,29.93-29.955v-190.6c0-16.548-13.406-29.93-29.93-29.93H354.676c-16.524,0-29.904,13.382-29.904,29.93,v190.6c0,16.523,13.38,29.955,29.904,29.955H545.299z\"/>
    <path id=\"path6712_1_\" fill=\"#FFFFFF\" stroke=\"#666666\" stroke-miterlimit=\"10\" d=\"M493.195,393.081,c-3.269,3.167-7.679,4.409-12.569,4.409c-6.209,0-11.86-2.534-15.104-7.325c-3.218,4.893-8.895,7.325-15.181,7.325,c-6.207,0-11.809-2.585-15.052-7.375c-3.219,4.942-8.896,7.375-15.256,7.375c-4.588,0-8.794-1.039-11.962-3.852l-2.408-17.233,c3.295,4.359,8.515,7.173,14.37,7.173c6.36,0,12.037-3.118,15.256-8.06c3.243,4.79,8.845,8.06,15.052,8.06,c6.286,0,11.963-3.118,15.181-8.009c3.244,4.789,8.896,8.009,15.104,8.009c6.335,0,11.936-3.27,15.129-8.212L493.195,393.081z\"/>
    <path id=\"path6714_1_\" fill=\"#FFFFFF\" stroke=\"#666666\" stroke-miterlimit=\"10\" d=\"M497.782,538.598l27.447-175.192l-18.476,0.177,l-24.962,156.541h-62.19l-24.961-156.541l-18.476-0.177l27.445,175.192H497.782z\"/>
    </g>";
  }
  //Naselje
  function printNaselje($ugao,$offset) { 
    // echo "<g id=\"voda-".$ugao."\" transform=\"translate(100,100)\">
    echo "<g id=\"naselje-".$ugao."\" transform=\"translate(".getCoordinates($ugao)[0]*$offset.",".getCoordinates($ugao)[1]*$offset.")\">
      <path fill=\"#999999\" d=\"M327.229,325.568c-25.127,25.129-37.967,38.521-37.967,39.546c0,2.364,8.586,10.633,11.027,10.633,c1.495,0,8.981-7.092,33.084-31.115c26.861-26.861,31.511-31.116,33.479-31.116c1.968,0,6.617,4.255,33.479,31.116,c24.498,24.42,31.589,31.115,33.084,31.115c2.441,0,11.028-8.352,11.028-10.633c0-2.208-75.466-77.591-77.591-77.591,C365.826,287.523,352.044,300.676,327.229,325.568z\"/>
      <path fill=\"#999999\" d=\"M396.551,291.934c-1.499,1.025-1.733,1.891-1.733,6.066v4.883l10.871,10.872,c5.909,5.909,11.106,10.794,11.424,10.794s0.552-6.931,0.552-15.361c0-19.301,0.473-18.51-11.263-18.51,C400.331,290.673,397.889,290.987,396.551,291.934z\"/>
      <path fill=\"#999999\" d=\"M335.186,353.852l-30.174,30.173v28.912c0,27.964,0.079,29.067,1.578,30.563,c1.498,1.494,2.598,1.576,18.749,1.576c14.256,0,17.41-0.234,18.905-1.26c1.733-1.182,1.733-1.338,1.733-22.846v-21.664,l1.969-1.891c1.891-1.97,1.891-1.97,18.906-1.97s17.016,0,18.905,1.97l1.969,1.891v21.664c0,21.504,0,21.664,1.733,22.846,c1.495,1.025,4.649,1.26,18.906,1.26c16.15,0,17.249-0.078,18.748-1.576s1.577-2.6,1.577-30.563v-28.912l-30.173-30.173,c-18.904-18.905-30.72-30.09-31.666-30.09C365.905,323.762,354.09,334.946,335.186,353.852z\"/>
      <path fill=\"#666666\" d=\"M468.311,362.221c-39.545,39.546-45.846,46.164-45.846,48.132c0,1.813,1.183,3.546,5.358,7.722,c8.824,8.742,4.488,11.656,48.604-32.454c32.926-32.928,38.127-37.813,40.174-37.813s7.248,4.885,40.176,37.813,c44.115,44.11,39.779,41.2,48.604,32.454c4.176-4.176,5.357-5.909,5.357-7.722c0-1.968-6.221-8.507-45.924-48.132,    c-40.252-40.33-46.162-45.923-48.209-45.923C514.473,316.298,508.643,321.891,468.311,362.221z\"/>
      <path fill=\"#666666\" d=\"M552.049,322.203c-1.654,1.578-1.969,2.677-1.969,6.853v4.963l13.627,13.626,c7.482,7.403,13.865,13.547,14.18,13.547c0.316,0,0.551-8.272,0.551-18.432c0-23.946,0.865-22.529-13.865-22.529,C554.33,320.234,553.857,320.313,552.049,322.203z\"/>
      <path fill=\"#666666\" d=\"M477.844,396.804l-36.474,36.474l0.157,35.291l0.234,35.369l1.891,1.494c1.733,1.418,3.311,1.5,22.924,1.5,s21.191-0.078,22.926-1.5l1.891-1.494l0.395-26.861c0.395-24.342,0.551-26.939,1.811-28.199c1.262-1.262,3.313-1.418,23.004-1.418,s21.738,0.156,23.004,1.418c1.26,1.26,1.416,3.857,1.813,28.199l0.395,26.861l1.891,1.494c1.732,1.418,3.307,1.5,22.924,1.5,c19.619,0,21.191-0.078,22.926-1.5l1.891-1.494l0.234-35.369l0.154-35.291l-36.471-36.474c-31.59-31.51-36.709-36.394-38.76-36.394,S509.432,365.294,477.844,396.804z\"/>
      <path fill=\"#333333\" d=\"M342.511,444.92l-53.249,53.172l0.473,3.072c0.395,2.363,1.655,4.098,6.301,8.664,c9.768,9.611,4.331,13.313,55.695-37.969c40.884-40.883,43.955-43.717,46.476-43.717c2.52,0,5.592,2.834,46.476,43.723,    c50.967,50.885,45.924,47.422,54.904,38.758c5.91-5.672,7.639-8.43,6.932-11.502c-0.314-1.416-16.781-18.432-52.621-54.275,c-47.104-47.109-52.462-52.228-55.221-52.701l-2.994-0.473L342.511,444.92z\"/>
      <path fill=\"#333333\" d=\"M439.876,397.654c-2.286,1.733-3.071,4.333-3.071,9.768v5.357l16.148,16.15l16.146,16.146v-22.291v-22.292,    l-1.967-1.891c-1.813-1.891-2.209-1.97-13.943-1.97C444.999,396.712,440.744,396.946,439.876,397.654z\"/>
      <path fill=\"#333333\" d=\"M353.542,485.018l-41.987,41.986v40.41v40.492l2.287,2.285l2.285,2.285h24.185h24.185l2.286-2.285,l2.285-2.285v-29.303c0-32.928,0-33.084,5.357-34.662c1.891-0.553,10.634-0.785,25.523-0.631l22.686,0.234l2.129,2.209l2.207,2.125,l0.396,30.959c0.234,16.936,0.552,30.959,0.631,31.037c0.078,0.078,1.182,0.709,2.52,1.416c1.891,0.947,6.301,1.182,25.918,1.182,h23.633l2.207-1.889l2.207-1.891l0.236-40.885l0.156-40.805l-42.004-41.986c-39.227-39.15-42.144-41.91-44.663-41.91,    C395.686,443.107,392.771,445.867,353.542,485.018z\"/>
      </g>";
  }
  //Hrana
  function printHrana($ugao,$offset) { 
    // echo "<g id=\"voda-".$ugao."\" transform=\"translate(100,100)\">
    echo "<g id=\"hrana-".$ugao."\" transform=\"translate(".getCoordinates($ugao)[0]*$offset.",".getCoordinates($ugao)[1]*$offset.")\">
      <path id=\"path6710_8_\" fill=\"#CC6600\" stroke=\"#AFA47C\" stroke-miterlimit=\"10\" d=\"M545.125,575,561.619,575,575,561.595,575,545.103V354.871C575,338.356,561.619,325,545.125,325H354.851C338.355,325,325,338.356,325,354.871,v190.231C325,561.595,338.355,575,354.851,575H545.125z\"/>
      <path fill=\"#FEFCF5\" d=\"M463.722,467.337l16.905-21.013c5.761,0.223,12.039-1.685,18.661-4.976l40.683-51.195l-4.093-8.231,l-30.456,38.326c-1.807,2.272-5.118,2.653-7.396,0.845c-2.273-1.809-2.653-5.119-0.845-7.395l30.455-38.324l-6.73-5.348,l-30.455,38.325c-1.808,2.274-5.117,2.655-7.396,0.848c-2.272-1.809-2.653-5.12-0.844-7.395l30.454-38.325l-8.944-2.125,l-41.481,52.203c-1.471,7.158-1.846,13.464-0.218,18.779l-13.522,16.807l-17.869-21.356c4.614-12.09,0.956-28.883-10.461-42.526,c-15.044-17.98-37.854-23.682-50.943-12.734c-13.09,10.951-11.504,34.405,3.544,52.387c11.416,13.644,27.296,20.208,40.016,17.805,    l20.843,24.908l-40.943,50.888c-4.001,5.029-3.163,12.349,1.868,16.347c5.029,3.993,12.351,3.155,16.347-1.874l37.952-47.167,l39.657,47.394c4.12,4.93,11.458,5.582,16.388,1.46c4.926-4.121,5.578-11.46,1.454-16.387L463.722,467.337z\"/>
      </g>";
  }

  $ulaz = $_GET["opis"];
  $elementi=explode("-",$ulaz);

  for ($i = sizeof($elementi) - 1; $i >= 0; $i--) {
    
    $prvoSlovo = substr($elementi[$i],0,1);

    switch($prvoSlovo) {
      case "v":
        printVoda(substr($elementi[$i],1),300);
        break;
      case "z":
        printZabrana(substr($elementi[$i],1),300);
        break;
      case "d":
        printPD(substr($elementi[$i],1),300);
        break;
      case "o":
        printOdmor(substr($elementi[$i],1),300);
        break;
      case "h":
        printHrana(substr($elementi[$i],1),300);
        break;
      case "n":
        printNaselje(substr($elementi[$i],1),300);
        break;
      case "r":
        printRijekaPotok(substr($elementi[$i],1));
        break;
      case "m":
        printMost(substr($elementi[$i],1));
        if ($i == 0) {
          printPutanja(substr($elementi[$i],1));
        } else {
          printSmjer(substr($elementi[$i],1));
        }
        break;
      case "p":
        printPrevoj(substr($elementi[$i],1));
        if ($i == 0) {
          printPutanja(substr($elementi[$i],1));
        } else {
          printSmjer(substr($elementi[$i],1));
        }
        break;
      default:
        if ($i == 0) {
          printPutanja($elementi[$i]);
        } else {
          printSmjer($elementi[$i]);
        }
    }
  }
  printPutanja(270);
?>
  </g>
</svg>